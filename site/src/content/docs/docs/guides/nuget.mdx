---
title: "NuGet / .NET Guide"
description: "Using Artifact Keeper as a NuGet package repository for .NET"
---

Artifact Keeper provides a fully compatible NuGet v3 repository for publishing and installing .NET packages.

## Endpoint

All NuGet operations use the `/nuget/{repo}` endpoint:

```
http://localhost:8080/nuget/default
```

For production:

```
https://registry.example.com/nuget/default
```

## Format Information

- **Format key**: `nuget`
- **Supported aliases**: `chocolatey`, `powershell` (route through NuGet handler)
- **API version**: NuGet v3 API

## Configuration

### nuget.config Configuration

Create or edit `nuget.config` in your project root or globally:

**Project-level** (`nuget.config` in project directory):

```xml
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <packageSources>
    <add key="ArtifactKeeper" value="http://localhost:8080/nuget/default/v3/index.json" />
  </packageSources>
</configuration>
```

**User-level** (`%AppData%\NuGet\NuGet.Config` on Windows, `~/.nuget/NuGet/NuGet.Config` on Linux/macOS):

```xml
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <packageSources>
    <add key="nuget.org" value="https://api.nuget.org/v3/index.json" protocolVersion="3" />
    <add key="ArtifactKeeper" value="http://localhost:8080/nuget/default/v3/index.json" />
  </packageSources>
</configuration>
```

### dotnet CLI Configuration

Add package source using the dotnet CLI:

```bash
dotnet nuget add source http://localhost:8080/nuget/default/v3/index.json --name ArtifactKeeper
```

For production:

```bash
dotnet nuget add source https://registry.example.com/nuget/default/v3/index.json --name ArtifactKeeper
```

List configured sources:

```bash
dotnet nuget list source
```

Remove a source:

```bash
dotnet nuget remove source ArtifactKeeper
```

### Visual Studio Configuration

1. Open **Tools** → **Options** → **NuGet Package Manager** → **Package Sources**
2. Click the **+** button to add a new source
3. Set **Name**: `ArtifactKeeper`
4. Set **Source**: `http://localhost:8080/nuget/default/v3/index.json`
5. Click **Update** and **OK**

## Authentication

### API Key Authentication

Add API key to nuget.config:

```xml
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <packageSources>
    <add key="ArtifactKeeper" value="http://localhost:8080/nuget/default/v3/index.json" />
  </packageSources>
  <packageSourceCredentials>
    <ArtifactKeeper>
      <add key="Username" value="your-username" />
      <add key="ClearTextPassword" value="your-api-key" />
    </ArtifactKeeper>
  </packageSourceCredentials>
</configuration>
```

### Encrypted Credentials

Store encrypted password (recommended for Windows):

```bash
dotnet nuget update source ArtifactKeeper --username your-username --password your-api-key --store-password-in-clear-text
```

Or use encrypted storage:

```bash
dotnet nuget update source ArtifactKeeper --username your-username --password your-api-key
```

### Basic Authentication

For basic auth, use credentials in nuget.config:

```xml
<packageSourceCredentials>
  <ArtifactKeeper>
    <add key="Username" value="your-username" />
    <add key="ClearTextPassword" value="your-password" />
  </ArtifactKeeper>
</packageSourceCredentials>
```

### Environment Variables

Use environment variables in CI/CD:

```bash
export NUGET_SOURCE=http://localhost:8080/nuget/default/v3/index.json
export NUGET_API_KEY=your-api-key
```

## Publishing Packages

### Create a Package

Build your project and create a NuGet package:

```bash
dotnet pack
```

This generates a `.nupkg` file in `bin/Debug` or `bin/Release`.

### Pack with Specific Configuration

```bash
dotnet pack --configuration Release --output ./packages
```

### Configure Package Metadata

Edit your `.csproj` file:

```xml
<Project Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <TargetFramework>net8.0</TargetFramework>
    <PackageId>MyCompany.MyPackage</PackageId>
    <Version>1.0.0</Version>
    <Authors>Your Name</Authors>
    <Company>Your Company</Company>
    <Description>A comprehensive description of your package</Description>
    <PackageLicenseExpression>MIT</PackageLicenseExpression>
    <PackageProjectUrl>https://github.com/mycompany/mypackage</PackageProjectUrl>
    <RepositoryUrl>https://github.com/mycompany/mypackage</RepositoryUrl>
    <RepositoryType>git</RepositoryType>
    <PackageTags>tag1;tag2;tag3</PackageTags>
    <PackageReleaseNotes>Initial release</PackageReleaseNotes>
  </PropertyGroup>
</Project>
```

### Publish with dotnet CLI

```bash
dotnet nuget push MyPackage.1.0.0.nupkg --source ArtifactKeeper --api-key your-api-key
```

For production:

```bash
dotnet nuget push MyPackage.1.0.0.nupkg \
  --source https://registry.example.com/nuget/default \
  --api-key your-api-key
```

### Publish with NuGet CLI

```bash
nuget push MyPackage.1.0.0.nupkg -Source http://localhost:8080/nuget/default -ApiKey your-api-key
```

### Publish All Packages in Directory

```bash
dotnet nuget push "packages/*.nupkg" --source ArtifactKeeper --api-key your-api-key
```

## Installing Packages

### Install with dotnet CLI

```bash
dotnet add package MyCompany.MyPackage
```

### Install Specific Version

```bash
dotnet add package MyCompany.MyPackage --version 1.0.0
```

### Install Prerelease Version

```bash
dotnet add package MyCompany.MyPackage --prerelease
```

### Install from Specific Source

```bash
dotnet add package MyCompany.MyPackage --source ArtifactKeeper
```

### PackageReference in .csproj

Add package reference directly to your project file:

```xml
<Project Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <TargetFramework>net8.0</TargetFramework>
  </PropertyGroup>

  <ItemGroup>
    <PackageReference Include="MyCompany.MyPackage" Version="1.0.0" />
  </ItemGroup>
</Project>
```

### Version Ranges

Use version ranges for flexible dependency management:

```xml
<PackageReference Include="MyCompany.MyPackage" Version="[1.0.0,2.0.0)" />
<!-- 1.0.0 <= version < 2.0.0 -->

<PackageReference Include="MyCompany.MyPackage" Version="1.*" />
<!-- Latest 1.x version -->

<PackageReference Include="MyCompany.MyPackage" Version="*" />
<!-- Latest version -->
```

### Restore Packages

```bash
dotnet restore
```

Restore from specific source:

```bash
dotnet restore --source http://localhost:8080/nuget/default/v3/index.json
```

## Version Management

### Semantic Versioning

Follow semantic versioning in your `.csproj`:

```xml
<PropertyGroup>
  <Version>1.0.0</Version>
</PropertyGroup>
```

### Increment Versions

Update version manually in `.csproj`:

```xml
<!-- Patch: 1.0.0 -> 1.0.1 -->
<Version>1.0.1</Version>

<!-- Minor: 1.0.0 -> 1.1.0 -->
<Version>1.1.0</Version>

<!-- Major: 1.0.0 -> 2.0.0 -->
<Version>2.0.0</Version>
```

### Prerelease Versions

Use prerelease suffixes:

```xml
<Version>1.0.0-alpha</Version>
<Version>1.0.0-beta.1</Version>
<Version>1.0.0-rc.2</Version>
```

### Version from Git Tag

Use MSBuild properties to version from Git:

```xml
<PropertyGroup>
  <VersionPrefix>1.0.0</VersionPrefix>
  <VersionSuffix Condition="'$(Configuration)' != 'Release'">$(VersionSuffix)</VersionSuffix>
</PropertyGroup>
```

### List Package Versions

```bash
dotnet list package --outdated
dotnet list package --deprecated
dotnet list package --vulnerable
```

### Search for Packages

```bash
dotnet package search MyPackage --source ArtifactKeeper
```

## Symbol Packages

### Create Symbol Package

Include symbols for debugging:

```xml
<PropertyGroup>
  <IncludeSymbols>true</IncludeSymbols>
  <SymbolPackageFormat>snupkg</SymbolPackageFormat>
</PropertyGroup>
```

```bash
dotnet pack --include-symbols --include-source
```

### Publish Symbol Package

```bash
dotnet nuget push MyPackage.1.0.0.nupkg --source ArtifactKeeper --api-key your-api-key
dotnet nuget push MyPackage.1.0.0.snupkg --source ArtifactKeeper --api-key your-api-key
```

## CI/CD Integration

### GitHub Actions

```yaml
name: Publish NuGet Package
on:
  push:
    tags:
      - 'v*'

jobs:
  publish:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Setup .NET
        uses: actions/setup-dotnet@v4
        with:
          dotnet-version: '8.0.x'

      - name: Restore dependencies
        run: dotnet restore

      - name: Build
        run: dotnet build --configuration Release --no-restore

      - name: Test
        run: dotnet test --no-restore --verbosity normal

      - name: Pack
        run: dotnet pack --configuration Release --no-build --output ./packages

      - name: Publish to Artifact Keeper
        run: |
          dotnet nuget push "./packages/*.nupkg" \
            --source https://registry.example.com/nuget/default \
            --api-key ${{ secrets.NUGET_API_KEY }} \
            --skip-duplicate
```

### GitLab CI

```yaml
stages:
  - build
  - publish

build:
  stage: build
  image: mcr.microsoft.com/dotnet/sdk:8.0
  script:
    - dotnet restore
    - dotnet build --configuration Release
    - dotnet test
    - dotnet pack --configuration Release --output ./packages
  artifacts:
    paths:
      - packages/*.nupkg

publish:
  stage: publish
  image: mcr.microsoft.com/dotnet/sdk:8.0
  script:
    - dotnet nuget push "packages/*.nupkg"
        --source https://registry.example.com/nuget/default
        --api-key $NUGET_API_KEY
        --skip-duplicate
  only:
    - tags
```

### Azure Pipelines

```yaml
trigger:
  tags:
    include:
      - v*

pool:
  vmImage: 'ubuntu-latest'

variables:
  buildConfiguration: 'Release'

steps:
- task: UseDotNet@2
  inputs:
    version: '8.0.x'

- script: dotnet restore
  displayName: 'Restore packages'

- script: dotnet build --configuration $(buildConfiguration)
  displayName: 'Build project'

- script: dotnet test --configuration $(buildConfiguration)
  displayName: 'Run tests'

- script: dotnet pack --configuration $(buildConfiguration) --output $(Build.ArtifactStagingDirectory)
  displayName: 'Pack NuGet packages'

- script: |
    dotnet nuget push "$(Build.ArtifactStagingDirectory)/*.nupkg" \
      --source https://registry.example.com/nuget/default \
      --api-key $(NUGET_API_KEY) \
      --skip-duplicate
  displayName: 'Publish to Artifact Keeper'
```

### Jenkins Pipeline

```groovy
pipeline {
    agent any

    environment {
        DOTNET_CLI_HOME = "/tmp/dotnet"
        NUGET_SOURCE = 'https://registry.example.com/nuget/default'
    }

    stages {
        stage('Restore') {
            steps {
                sh 'dotnet restore'
            }
        }

        stage('Build') {
            steps {
                sh 'dotnet build --configuration Release --no-restore'
            }
        }

        stage('Test') {
            steps {
                sh 'dotnet test --no-restore'
            }
        }

        stage('Pack') {
            steps {
                sh 'dotnet pack --configuration Release --no-build --output ./packages'
            }
        }

        stage('Publish') {
            when {
                tag "v*"
            }
            steps {
                withCredentials([
                    string(credentialsId: 'nuget-api-key', variable: 'NUGET_API_KEY')
                ]) {
                    sh '''
                        dotnet nuget push "packages/*.nupkg" \
                          --source ${NUGET_SOURCE} \
                          --api-key ${NUGET_API_KEY} \
                          --skip-duplicate
                    '''
                }
            }
        }
    }
}
```

## Advanced Configuration

### Multiple Package Sources

Configure multiple NuGet sources:

```xml
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <packageSources>
    <add key="nuget.org" value="https://api.nuget.org/v3/index.json" />
    <add key="ArtifactKeeper" value="https://registry.example.com/nuget/default/v3/index.json" />
    <add key="ArtifactKeeper-Internal" value="https://registry.example.com/nuget/internal/v3/index.json" />
  </packageSources>
  <packageSourceCredentials>
    <ArtifactKeeper>
      <add key="Username" value="user1" />
      <add key="ClearTextPassword" value="key1" />
    </ArtifactKeeper>
    <ArtifactKeeper-Internal>
      <add key="Username" value="user2" />
      <add key="ClearTextPassword" value="key2" />
    </ArtifactKeeper-Internal>
  </packageSourceCredentials>
</configuration>
```

### Package Source Mapping

Route specific packages to specific sources (NuGet 6.0+):

```xml
<packageSourceMapping>
  <packageSource key="nuget.org">
    <package pattern="*" />
  </packageSource>
  <packageSource key="ArtifactKeeper">
    <package pattern="MyCompany.*" />
    <package pattern="Internal.*" />
  </packageSource>
</packageSourceMapping>
```

### Fallback Sources

Configure fallback package sources:

```xml
<fallbackPackageFolders>
  <add key="shared-packages" value="/opt/nuget-packages" />
</fallbackPackageFolders>
```

### Proxy Configuration

```xml
<config>
  <add key="http_proxy" value="http://proxy.example.com:8080" />
  <add key="http_proxy.user" value="proxyuser" />
  <add key="http_proxy.password" value="proxypass" />
</config>
```

## Package Management

### Update Packages

Update all packages:

```bash
dotnet list package --outdated
dotnet add package MyCompany.MyPackage
```

### Remove Package

```bash
dotnet remove package MyCompany.MyPackage
```

### Clear NuGet Cache

```bash
dotnet nuget locals all --clear
```

### Verify Package Integrity

```bash
dotnet nuget verify MyPackage.1.0.0.nupkg
```

## Troubleshooting

### Authentication Errors

Verify credentials:

```bash
dotnet nuget list source
```

Test authentication:

```bash
dotnet nuget push --help
```

Check nuget.config location:

```bash
# Windows
%AppData%\NuGet\NuGet.Config

# Linux/macOS
~/.nuget/NuGet/NuGet.Config
```

### Publishing Failures

Enable detailed logging:

```bash
dotnet nuget push MyPackage.1.0.0.nupkg \
  --source ArtifactKeeper \
  --api-key your-api-key \
  --verbosity detailed
```

Validate package before publishing:

```bash
dotnet nuget verify MyPackage.1.0.0.nupkg
```

### Installation Issues

Clear all caches:

```bash
dotnet nuget locals all --clear
```

Force package restore:

```bash
dotnet restore --force --no-cache
```

Check package source availability:

```bash
dotnet nuget list source
curl http://localhost:8080/nuget/default/v3/index.json
```

### Version Conflicts

List all package versions:

```bash
dotnet list package --include-transitive
```

Check for outdated packages:

```bash
dotnet list package --outdated
```

### SSL Certificate Errors

For self-signed certificates, disable SSL verification (not recommended for production):

```xml
<config>
  <add key="signatureValidationMode" value="accept" />
</config>
```

Or install the certificate in your system's trusted root store.

## Best Practices

### Semantic Versioning

- **Major** (1.0.0 -> 2.0.0): Breaking API changes
- **Minor** (1.0.0 -> 1.1.0): New features, backward compatible
- **Patch** (1.0.0 -> 1.0.1): Bug fixes and patches

### Package Metadata

Include comprehensive metadata in `.csproj`:

```xml
<PropertyGroup>
  <PackageId>MyCompany.MyPackage</PackageId>
  <Version>1.0.0</Version>
  <Authors>Your Name</Authors>
  <Company>Your Company</Company>
  <Description>Detailed package description</Description>
  <Copyright>Copyright (c) 2024 Your Company</Copyright>
  <PackageLicenseExpression>MIT</PackageLicenseExpression>
  <PackageProjectUrl>https://github.com/mycompany/mypackage</PackageProjectUrl>
  <RepositoryUrl>https://github.com/mycompany/mypackage</RepositoryUrl>
  <RepositoryType>git</RepositoryType>
  <PackageTags>dotnet;csharp;library</PackageTags>
  <PackageReleaseNotes>See CHANGELOG.md</PackageReleaseNotes>
  <PackageReadmeFile>README.md</PackageReadmeFile>
  <PackageIcon>icon.png</PackageIcon>
</PropertyGroup>

<ItemGroup>
  <None Include="README.md" Pack="true" PackagePath="/" />
  <None Include="icon.png" Pack="true" PackagePath="/" />
</ItemGroup>
```

### Exclude Development Files

Use `.nuspec` or `.csproj` to exclude unnecessary files:

```xml
<ItemGroup>
  <Content Remove="**/*.Development.json" />
  <None Remove="**/*.Development.json" />
</ItemGroup>
```

### Multi-Targeting

Support multiple .NET versions:

```xml
<PropertyGroup>
  <TargetFrameworks>net8.0;net7.0;net6.0;netstandard2.1</TargetFrameworks>
</PropertyGroup>
```

### Source Link

Enable Source Link for better debugging:

```xml
<PropertyGroup>
  <PublishRepositoryUrl>true</PublishRepositoryUrl>
  <EmbedUntrackedSources>true</EmbedUntrackedSources>
  <DebugType>embedded</DebugType>
</PropertyGroup>

<ItemGroup>
  <PackageReference Include="Microsoft.SourceLink.GitHub" Version="8.0.0" PrivateAssets="All" />
</ItemGroup>
```

### Lock Files

Use package lock files for reproducible builds:

```xml
<PropertyGroup>
  <RestorePackagesWithLockFile>true</RestorePackagesWithLockFile>
</PropertyGroup>
```

## See Also

- [Security Scanning](/docs/security/scanning) - Automatic vulnerability scanning for NuGet packages
- [Security Policies](/docs/security/policies) - Configure policies to block vulnerable packages
